// Generated by CoffeeScript 2.5.1
(function() {
  var assert, createCargo, isInited;

  ({createCargo, isInited} = require("../"));

  assert = require("assert");

  describe("init clickhouse_cargo", function() {
    it("auto init when env set", function(done) {
      assert(isInited(), "should auto init when env set");
      done();
    });
    it("cargo must be created with an insert statement", function(done) {
      var cargo, query;
      assert.throws((function() {
        return createCargo();
      }), Error, /blank/);
      assert.throws((function() {
        return createCargo("select * from dual");
      }), Error, /insert/);
      query = "INSERT INTO test.cargo0 FORMAT JSONCompactEachRow";
      cargo = createCargo(query);
      assert(cargo);
      assert(cargo.id);
      assert(cargo.curBulk);
      done();
    });
  });

}).call(this);
